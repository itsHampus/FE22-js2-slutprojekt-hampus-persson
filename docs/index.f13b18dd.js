function e(e,t,s,n){Object.defineProperty(e,t,{get:s,set:n,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},n={},r=t.parcelRequire9b8f;null==r&&((r=function(e){if(e in s)return s[e].exports;if(e in n){var t=n[e];delete n[e];var r={id:e,exports:{}};return s[e]=r,t.call(r.exports,r,r.exports),r.exports}var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){n[e]=t},t.parcelRequire9b8f=r),r.register("27Lyk",(function(t,s){var n,r;e(t.exports,"register",(()=>n),(e=>n=e)),e(t.exports,"resolve",(()=>r),(e=>r=e));var a={};n=function(e){for(var t=Object.keys(e),s=0;s<t.length;s++)a[t[s]]=e[t[s]]},r=function(e){var t=a[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),r("27Lyk").register(JSON.parse('{"5ReQc":"index.f13b18dd.js","6BjcK":"animal-leao-lion-svgrepo-com.3298cfa5.svg","ljGDz":"animal-bull-bulls-svgrepo-com.8bfc578b.svg","bazO7":"animal-duck-ducks-svgrepo-com.d97cb9d9.svg"}'));class a{constructor(){}async getAllUsers(){const e=await fetch("https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/.json");return await e.json()}async CreateUser(e,t){const s=`https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/${t}.json`,n={method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json: charset=UTF-8"}};await fetch(s,n)}async updateUserPosts(e,t,s){const n=`https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/${s}/posts.json`,r={method:"POST",body:JSON.stringify({post:e,timestamp:t}),headers:{"Content-type":"application/json: charset=UTF-8"}};await fetch(n,r)}async deleteUserPost(e,t){const s=`https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/${t}/posts/${e}.json`;await fetch(s,{method:"DELETE",headers:{"Content-type":"application/json: charset=UTF-8"}})}async deleteUserFromFirebase(){await fetch("https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/.json",{method:"DELETE",headers:{"Content-type":"application/json: charset=UTF-8"}})}}var o;o=new URL(r("27Lyk").resolve("6BjcK"),import.meta.url).toString();var i;i=new URL(r("27Lyk").resolve("ljGDz"),import.meta.url).toString();var l;l=new URL(r("27Lyk").resolve("bazO7"),import.meta.url).toString();class c{createUserContainer=document.getElementById("createUserContainer");loginContainer=document.getElementById("loginContainer");homePageContainer=document.getElementById("homePageContainer");profilePageContainer=document.getElementById("profilePageContainer");displayProfilePicture=document.getElementById("displayProfilePicture");profilePicture=document.getElementById("profilePicture");switchToCreateUser=document.querySelector("#loginContainer h5");switchToLogin=document.querySelector("#createUserContainer h5");constructor(){this.switchToCreateUser.addEventListener("click",(()=>{this.createUser()})),this.switchToLogin.addEventListener("click",(()=>{this.createLogin()}))}createLogin(){this.loginContainer.style.display="flex",this.createUserContainer.style.display="none",this.homePageContainer.style.display="none",this.profilePageContainer.style.display="none"}createUser(){this.createUserContainer.style.display="flex",this.loginContainer.style.display="none",this.homePageContainer.style.display="none",this.profilePageContainer.style.display="none"}createHomePage(){this.homePageContainer.style.display="flex",this.createUserContainer.style.display="none",this.loginContainer.style.display="none",this.profilePageContainer.style.display="none"}createProfilePage(){this.profilePageContainer.style.display="flex",this.homePageContainer.style.display="none",this.createUserContainer.style.display="none",this.loginContainer.style.display="none"}userProfilePicture(e,t){if("animal-leao-lion-svgrepo-com.svg"==e&&!0===t){const e=new URL(o);this.displayProfilePicture.src=e.href}else if("animal-bull-bulls-svgrepo-com.svg"==e&&!0===t){const e=new URL(i);this.displayProfilePicture.src=e.href}else if("animal-duck-ducks-svgrepo-com.svg"==e&&!0===t){const e=new URL(l);this.displayProfilePicture.src=e.href}else if("animal-leao-lion-svgrepo-com.svg"==e&&!1===t){const e=new URL(o);this.profilePicture.src=e.href}else if("animal-bull-bulls-svgrepo-com.svg"==e&&!1===t){const e=new URL(i);this.profilePicture.src=e.href}else if("animal-duck-ducks-svgrepo-com.svg"==e&&!1===t){const e=new URL(l);this.profilePicture.src=e.href}}returnPictureUrl(e){if("animal-leao-lion-svgrepo-com.svg"==e){return new URL(o)}if("animal-bull-bulls-svgrepo-com.svg"==e){return new URL(i)}if("animal-duck-ducks-svgrepo-com.svg"==e){return new URL(l)}}}class u{gui=new c;firebase=new a;constructor(){}async homePage(){this.gui.createHomePage(),await this.allUsersPosts(),document.getElementById("listOfAllUsers").innerHTML="",(await this.firebase.getAllUsers()).forEach((e=>{if(e.username===localStorage.getItem("username")){document.getElementById("displayUsername").innerText=e.username,this.gui.userProfilePicture(e.profilePicture,!0)}const t=document.createElement("li");t.innerText=e.username,document.getElementById("listOfAllUsers").append(t)}));document.getElementById("logOutBtn").addEventListener("click",(()=>{localStorage.clear(),window.location.href="./index.html"}))}async deleteUser(){document.getElementById("deleteAccountBtn").addEventListener("click",(async()=>{if(confirm("Are you sure you want to delete your account?")){const e=await this.firebase.getAllUsers();e.forEach((async(t,s)=>{t.username===localStorage.getItem("username")&&(await this.firebase.deleteUserFromFirebase(),e.splice(s,1),e.forEach((async(e,t)=>{await this.firebase.CreateUser(e,t),localStorage.clear(),window.location.href="./index.html"})))}))}}))}async addPost(){document.getElementById("userStatusUpdateForm").addEventListener("submit",(async e=>{e.preventDefault();let t=document.getElementById("userStatusUpdate").value;await this.statusUpdate(t).then((async()=>{await this.allUsersPosts()}))}))}async statusUpdate(e){const t=await this.firebase.getAllUsers(),s=t.find((e=>e.username===localStorage.getItem("username")));if(void 0!==s){const n=t.indexOf(s),r=(new Date).toLocaleString();await this.firebase.updateUserPosts(e,r,n)}document.getElementById("userStatusUpdate").value=""}async allUsersPosts(){const e=await this.firebase.getAllUsers();document.getElementById("everyStatusUpdateContainer").innerHTML="";let t=[];e.forEach((e=>{if(void 0!==e.posts){Object.values(e.posts).forEach((({post:s,timestamp:n})=>{const r={username:e.username,picture:e.profilePicture,p:s,t:n};t.push(r)}))}})),t.sort(((e,t)=>new Date(t.t).getTime()-new Date(e.t).getTime())),t.forEach((e=>{const t=document.createElement("h5");t.innerText=e.username;const s=document.createElement("img"),n=this.gui.returnPictureUrl(e.picture);s.src=n?.href;const r=document.createElement("p");r.innerText=e.p;const a=document.createElement("p");a.innerText=e.t;const o=document.createElement("div");o.id="postContainer",o.append(t,s,r,a),document.getElementById("everyStatusUpdateContainer").append(o)}))}}class d{gui=new c;firebase=new a;constructor(){}async profilePage(e){this.gui.createProfilePage();let t=[],s=[],n=[];(await this.firebase.getAllUsers()).forEach((r=>{if(r.username===e){if(document.getElementById("profileUsername").innerText=r.username,this.gui.userProfilePicture(r.profilePicture,!1),void 0!==r.posts){Object.values(r.posts).forEach((({post:e,timestamp:s},a)=>{const o={username:r.username,picture:r.profilePicture,p:e,t:s};t.push(o),n.push(a)})),Object.keys(r.posts).forEach((e=>{s.push(e)}))}else{const e=document.createElement("p");e.innerText="No posts yet",document.getElementById("profileStatusContainer").append(e)}}})),t.sort(((e,t)=>new Date(t.t).getTime()-new Date(e.t).getTime())),n.reverse(),t.forEach(((e,t)=>{const r=document.createElement("div");r.id="containerForTheProfilePost";const a=document.createElement("h5");a.innerText=e.username;const o=document.createElement("img"),i=this.gui.returnPictureUrl(e.picture);o.src=i.href;const l=document.createElement("p");l.innerText=e.p;const c=document.createElement("p");if(c.innerText=e.t,e.username===localStorage.getItem("username")){const e=document.createElement("button");e.innerText="Delete post",e.value=t.toString(),e.addEventListener("click",(async()=>{if(confirm("Are you sure you want to delete this post?")){(await this.firebase.getAllUsers()).forEach((async(t,r)=>{if(t.username===localStorage.getItem("username")){const t=n[e.value];await this.firebase.deleteUserPost(s[t],r),document.getElementById("profileStatusContainer").innerHTML="",this.profilePage(localStorage.getItem("username"))}}))}})),r.append(a,o,l,c,e)}else r.append(a,o,l,c);document.getElementById("profileStatusContainer").append(r)}))}}(new c).createLogin();const m=new class{firebase=new a;homePage=new u;profilePage=new d;constructor(){null!=localStorage.getItem("username")&&this.goToHomeOrProfile(!0)}async createUser(){const e=document.getElementById("createUsername").value,t=document.getElementById("createPassword").value,s=document.getElementById("verifyPassword").value,n=document.getElementById("selectPicture").value;if(t===s){const s={username:e,password:t,profilePicture:n},r=await this.firebase.getAllUsers();if(null!==r){const e=r.length;await this.firebase.CreateUser(s,e)}else{const e=0;await this.firebase.CreateUser(s,e)}localStorage.setItem("username",s.username),this.goToHomeOrProfile(!0)}else alert("Passwords do not match")}async logIn(){const e=document.getElementById("username").value,t=document.getElementById("password").value,s=await this.firebase.getAllUsers();0==this.checkIfUserExists(e,t,s)&&alert("User not found")}checkIfUserExists(e,t,s){let n=!1;return s.forEach((s=>{s.username===e&&(n=!0,s.password===t?(localStorage.setItem("username",s.username),n=!0,this.goToHomeOrProfile(!0)):alert("Wrong password"))})),n}goToHomeOrProfile(e,t){1==e?this.homePage.homePage().then((()=>{this.addEventListenersOnListOfUsers()})):this.profilePage.profilePage(t)}addEventListenersOnListOfUsers(){document.querySelectorAll("#listOfAllUsers li").forEach((e=>{e.addEventListener("click",(()=>{this.goToHomeOrProfile(!1,e.innerText)}))}))}},p=new u;document.getElementById("createUserForm").addEventListener("submit",(async e=>{e.preventDefault(),m.createUser()}));document.getElementById("loginForm").addEventListener("submit",(e=>{e.preventDefault(),m.logIn()}));document.getElementById("backToHomeBtn").addEventListener("click",(()=>{console.log("Back to Home"),m.goToHomeOrProfile(!0),document.getElementById("profileStatusContainer").innerHTML=""})),p.addPost(),p.deleteUser();
//# sourceMappingURL=index.f13b18dd.js.map
