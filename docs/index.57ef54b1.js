function e(e,t,s,n){Object.defineProperty(e,t,{get:s,set:n,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s={},n={},a=t.parcelRequire9b8f;null==a&&((a=function(e){if(e in s)return s[e].exports;if(e in n){var t=n[e];delete n[e];var a={id:e,exports:{}};return s[e]=a,t.call(a.exports,a,a.exports),a.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){n[e]=t},t.parcelRequire9b8f=a),a.register("27Lyk",(function(t,s){var n,a;e(t.exports,"register",(()=>n),(e=>n=e)),e(t.exports,"resolve",(()=>a),(e=>a=e));var r={};n=function(e){for(var t=Object.keys(e),s=0;s<t.length;s++)r[t[s]]=e[t[s]]},a=function(e){var t=r[e];if(null==t)throw new Error("Could not resolve bundle with id "+e);return t}})),a("27Lyk").register(JSON.parse('{"5ReQc":"index.57ef54b1.js","6BjcK":"animal-leao-lion-svgrepo-com.3298cfa5.svg","ljGDz":"animal-bull-bulls-svgrepo-com.8bfc578b.svg","bazO7":"animal-duck-ducks-svgrepo-com.d97cb9d9.svg"}'));class r{constructor(){}async getAllUsers(){const e=await fetch("https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/.json");return await e.json()}async CreateUser(e,t){const s=`https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/${t}.json`,n={method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json: charset=UTF-8"}};await fetch(s,n)}async updateUserPosts(e,t,s){const n=`https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/${s}/posts.json`,a={method:"POST",body:JSON.stringify({post:e,timestamp:t}),headers:{"Content-type":"application/json: charset=UTF-8"}};await fetch(n,a)}async deleteUserPost(e,t){const s=`https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/${t}/posts/${e}.json`;await fetch(s,{method:"DELETE",headers:{"Content-type":"application/json: charset=UTF-8"}})}async deleteUser(){await fetch("https://slutprojekt-socialmedia-default-rtdb.europe-west1.firebasedatabase.app/.json",{method:"DELETE",headers:{"Content-type":"application/json: charset=UTF-8"}})}}var o;o=new URL(a("27Lyk").resolve("6BjcK"),import.meta.url).toString();var i;i=new URL(a("27Lyk").resolve("ljGDz"),import.meta.url).toString();var l;l=new URL(a("27Lyk").resolve("bazO7"),import.meta.url).toString();class c{createUserContainer=document.getElementById("createUserContainer");loginContainer=document.getElementById("loginContainer");homePageContainer=document.getElementById("homePageContainer");profilePageContainer=document.getElementById("profilePageContainer");displayProfilePicture=document.getElementById("displayProfilePicture");profilePicture=document.getElementById("profilePicture");switchToCreateUser=document.querySelector("#loginContainer h5");switchToLogin=document.querySelector("#createUserContainer h5");constructor(){this.switchToCreateUser.addEventListener("click",(()=>{this.createUser()})),this.switchToLogin.addEventListener("click",(()=>{this.createLogin()}))}createLogin(){this.loginContainer.style.display="block",this.createUserContainer.style.display="none",this.homePageContainer.style.display="none",this.profilePageContainer.style.display="none"}createUser(){this.createUserContainer.style.display="block",this.loginContainer.style.display="none",this.homePageContainer.style.display="none",this.profilePageContainer.style.display="none"}createHomePage(){this.homePageContainer.style.display="block",this.createUserContainer.style.display="none",this.loginContainer.style.display="none",this.profilePageContainer.style.display="none"}createProfilePage(){this.profilePageContainer.style.display="block",this.homePageContainer.style.display="none",this.createUserContainer.style.display="none",this.loginContainer.style.display="none"}userProfilePicture(e,t){if("animal-leao-lion-svgrepo-com.svg"==e&&!0===t){const e=new URL(o);this.displayProfilePicture.src=e.href}else if("animal-bull-bulls-svgrepo-com.svg"==e&&!0===t){const e=new URL(i);this.displayProfilePicture.src=e.href}else if("animal-duck-ducks-svgrepo-com.svg"==e&&!0===t){const e=new URL(l);this.displayProfilePicture.src=e.href}else if("animal-leao-lion-svgrepo-com.svg"==e&&!1===t){const e=new URL(o);this.profilePicture.src=e.href}else if("animal-bull-bulls-svgrepo-com.svg"==e&&!1===t){const e=new URL(i);this.profilePicture.src=e.href}else if("animal-duck-ducks-svgrepo-com.svg"==e&&!1===t){const e=new URL(l);this.profilePicture.src=e.href}}}class d{gui=new c;firebase=new r;constructor(){}async homePage(){this.gui.createHomePage(),await this.allUsersPosts(),document.getElementById("listOfAllUsers").innerHTML="",(await this.firebase.getAllUsers()).forEach((e=>{if(e.username===localStorage.getItem("username")){document.getElementById("displayUsername").innerText=e.username,this.gui.userProfilePicture(e.profilePicture,!0)}const t=document.createElement("li");t.innerText=e.username,document.getElementById("listOfAllUsers").append(t)}));document.getElementById("userStatusUpdateForm").addEventListener("submit",(async e=>{console.trace(),e.preventDefault();let t=document.getElementById("userStatusUpdate").value;await this.statusUpdate(t).then((async()=>{await this.allUsersPosts()}))}));document.getElementById("logOutBtn").addEventListener("click",(()=>{localStorage.clear(),window.location.href="./index.html"}));document.getElementById("deleteAccountBtn").addEventListener("click",(async()=>{if(confirm("Are you sure you want to delete your account?")){const e=await this.firebase.getAllUsers();e.forEach((async(t,s)=>{t.username===localStorage.getItem("username")&&(await this.firebase.deleteUser(),e.splice(s,1),e.forEach((async(e,t)=>{await this.firebase.CreateUser(e,t),localStorage.clear(),window.location.href="./index.html"})))}))}}))}async statusUpdate(e){console.trace();const t=await this.firebase.getAllUsers(),s=t.find((e=>e.username===localStorage.getItem("username")));if(void 0!==s){const n=t.indexOf(s),a=(new Date).toLocaleString();await this.firebase.updateUserPosts(e,a,n)}document.getElementById("userStatusUpdate").value=""}async allUsersPosts(){const e=await this.firebase.getAllUsers();document.getElementById("everyStatusUpdateContainer").innerHTML="";let t=[];e.forEach((e=>{if(void 0!==e.posts){Object.values(e.posts).forEach((({post:s,timestamp:n})=>{const a={username:e.username,p:s,t:n};t.push(a)}))}})),t.sort(((e,t)=>new Date(t.t).getTime()-new Date(e.t).getTime())),t.forEach((e=>{const t=document.createElement("h5");t.innerText=e.username;const s=document.createElement("p");s.innerText=e.p;const n=document.createElement("p");n.innerText=e.t;const a=document.createElement("div");a.id="postContainer",a.append(t,s,n),document.getElementById("everyStatusUpdateContainer").append(a)}))}}class u{gui=new c;firebase=new r;constructor(){}async profilePage(e){this.gui.createProfilePage();let t=[],s=[],n=[];(await this.firebase.getAllUsers()).forEach((a=>{if(a.username===e){if(document.getElementById("profileUsername").innerText=a.username,this.gui.userProfilePicture(a.profilePicture,!1),void 0!==a.posts){Object.values(a.posts).forEach((({post:e,timestamp:s},r)=>{const o={username:a.username,p:e,t:s};t.push(o),n.push(r)})),Object.keys(a.posts).forEach((e=>{s.push(e)}))}else{const e=document.createElement("p");e.innerText="No posts yet",document.getElementById("profileStatusContainer").append(e)}}})),t.sort(((e,t)=>new Date(t.t).getTime()-new Date(e.t).getTime())),n.reverse(),t.forEach(((e,t)=>{const a=document.createElement("div");a.id="containerForTheProfilePost";const r=document.createElement("h5");r.innerText=e.username;const o=document.createElement("p");o.innerText=e.p;const i=document.createElement("p");if(i.innerText=e.t,e.username===localStorage.getItem("username")){const e=document.createElement("button");e.innerText="Delete post",e.value=t.toString(),e.addEventListener("click",(async()=>{if(confirm("Are you sure you want to delete this post?")){(await this.firebase.getAllUsers()).forEach((async(t,a)=>{if(t.username===localStorage.getItem("username")){const t=n[e.value];await this.firebase.deleteUserPost(s[t],a),document.getElementById("profileStatusContainer").innerHTML="",this.profilePage(localStorage.getItem("username"))}}))}})),a.append(r,o,i,e)}else a.append(r,o,i);document.getElementById("profileStatusContainer").append(a)}))}}(new c).createLogin();const m=new class{firebase=new r;homePage=new d;profilePage=new u;constructor(){null!=localStorage.getItem("username")&&this.goToHomeOrProfile(!0)}async createUser(){const e=document.getElementById("createUsername").value,t=document.getElementById("createPassword").value,s=document.getElementById("verifyPassword").value,n=document.getElementById("selectPicture").value;if(t===s){const s={username:e,password:t,profilePicture:n},a=await this.firebase.getAllUsers();if(null!==a){const e=a.length;await this.firebase.CreateUser(s,e)}else{const e=0;await this.firebase.CreateUser(s,e)}localStorage.setItem("username",s.username),this.goToHomeOrProfile(!0)}else alert("Passwords do not match")}async logIn(){const e=document.getElementById("username").value,t=document.getElementById("password").value,s=await this.firebase.getAllUsers();0==this.checkIfUserExists(e,t,s)&&alert("User not found")}checkIfUserExists(e,t,s){let n=!1;return s.forEach((s=>{s.username===e&&(n=!0,s.password===t?(localStorage.setItem("username",s.username),n=!0,this.goToHomeOrProfile(!0)):alert("Wrong password"))})),n}goToHomeOrProfile(e,t){return console.trace(),1==e?void this.homePage.homePage().then((()=>{this.addEventListenersOnListOfUsers()})):void this.profilePage.profilePage(t)}addEventListenersOnListOfUsers(){document.querySelectorAll("#listOfAllUsers li").forEach((e=>{e.addEventListener("click",(()=>{this.goToHomeOrProfile(!1,e.innerText)}))}))}};document.getElementById("createUserForm").addEventListener("submit",(async e=>{e.preventDefault(),m.createUser()}));document.getElementById("loginForm").addEventListener("submit",(e=>{e.preventDefault(),m.logIn()}));document.getElementById("backToHomeBtn").addEventListener("click",(()=>{console.log("Back to Home"),m.goToHomeOrProfile(!0),document.getElementById("profileStatusContainer").innerHTML=""}));
//# sourceMappingURL=index.57ef54b1.js.map
